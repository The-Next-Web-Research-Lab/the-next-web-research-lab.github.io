import{_ as c}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as i,c as l,a as s,b as n,d as a,w as u,e}from"./app-36fbb5c6.js";const r={},d=s("h1",{id:"functional-programming-theorem-2",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#functional-programming-theorem-2","aria-hidden":"true"},"#"),n(" Functional programming theorem 2")],-1),k=s("h2",{id:"purpose-of-writing",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#purpose-of-writing","aria-hidden":"true"},"#"),n(" purpose of writing")],-1),m=e('<p>It suddenly occurred to me that in order to understand functional types more deeply, I would need to learn a language that strongly supports functional types. So, I learned through books written in languages ​​other than JavaScript. The books referenced are the following three.</p><ul><li>Chris Okasaki. 『Pure Functional Data Structure』. Oh Hyun-seok (translation). Acorn Publishing, 2019.</li><li>Neil Ford. 『Functional Thinking』. Kim Jae-wan (translation). Hanbit Media, 2016.</li><li>Stuart Holloway. 『Programming Closure』. Yoo Chan-woo (translation). Insight, 2010.</li></ul><p>I summarized the features of functional types learned through this book.</p><h2 id="index" tabindex="-1"><a class="header-anchor" href="#index" aria-hidden="true">#</a> index</h2><ul><li>Special syntax supported by functional languages <ul><li>Operator overloading</li><li>pattern matching</li></ul></li><li>Shift to functional thinking <ul><li>recursive thinking</li><li>Memoization</li><li>Lazy evaluation</li></ul></li><li>Functional data structure <ul><li>Lazy Lists</li><li>persistent data structures</li></ul></li></ul><h2 id="special-syntax-supported-by-functional-languages" tabindex="-1"><a class="header-anchor" href="#special-syntax-supported-by-functional-languages" aria-hidden="true">#</a> Special syntax supported by functional languages</h2><p>This is about the special grammar I learned while learning functional languages.</p><h3 id="operator-overloading" tabindex="-1"><a class="header-anchor" href="#operator-overloading" aria-hidden="true">#</a> Operator overloading</h3><p>A common feature of functional languages ​​is operator overloading. Operator overloading is a function that defines new operators such as <code>+</code>, <code>-</code>, and <code>*</code>, applies them to new data types, and performs new actions. I think this is possible because in functional languages, operators are viewed not simply as operators but as functions.</p>',9),v={href:"https://github.com/tc39/proposal-operator-overloading",target:"_blank",rel:"noopener noreferrer"},h=s("h3",{id:"pattern-matching",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#pattern-matching","aria-hidden":"true"},"#"),n(" pattern matching")],-1),b={href:"https://github.com/tc39/proposal-pattern-matching",target:"_blank",rel:"noopener noreferrer"},g=e(`<h4 id="tc39-proposal-pattern-matching" tabindex="-1"><a class="header-anchor" href="#tc39-proposal-pattern-matching" aria-hidden="true">#</a> tc39/proposal-pattern-matching</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  when <span class="token punctuation">{</span><span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span> <span class="token operator">-</span><span class="token operator">&gt;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Ok</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  when <span class="token punctuation">{</span><span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">}</span> <span class="token operator">-</span><span class="token operator">&gt;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;not found&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  when <span class="token punctuation">{</span>status<span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&gt;=</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;something is wrong&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="shift-to-functional-thinking" tabindex="-1"><a class="header-anchor" href="#shift-to-functional-thinking" aria-hidden="true">#</a> Shift to functional thinking</h2><p>Functional writing involves writing code, but I felt that a change in thinking was necessary. He summarized what he believed to be functional thinking.</p><h3 id="recursive-thinking" tabindex="-1"><a class="header-anchor" href="#recursive-thinking" aria-hidden="true">#</a> recursive thinking</h3><p>Recursion can be solved by separating the problem into smaller problems while hiding mutable state. Because functional types avoid mutable states, they solve problems through recursion rather than creating states.</p><p>For example, the range and map functions are as follows:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token parameter">end<span class="token punctuation">,</span> start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&gt;</span> end <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>start<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token function">range</span><span class="token punctuation">(</span>end<span class="token punctuation">,</span> start<span class="token operator">+</span>step<span class="token punctuation">,</span> step<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// []</span>
<span class="token function">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// [0, 1, 2]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token punctuation">[</span>head<span class="token punctuation">,</span> <span class="token operator">...</span>tail<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token function">fn</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token function">map</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> tail<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// [0, 10, 20]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It is known that it is good to follow the following rules when creating a recursive function.</p><ul><li>You have to know when to stop.</li><li>Decide what to do in a step.</li><li>Separate the problem into smaller problems or problems that can be solved in one step.</li></ul><p>However, because JavaScript has a limit on the number of recursive calls, stack corruption easily occurs if too many recursive calls are made. To prevent stack breakage, a structure called a trampoline can be used to avoid stack breakage.</p><h4 id="trampoline-structure" tabindex="-1"><a class="header-anchor" href="#trampoline-structure" aria-hidden="true">#</a> trampoline structure</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// Code that causes stack corruption</span>
<span class="token keyword">const</span> <span class="token function-variable function">evenSteven</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span>
  <span class="token boolean">true</span> <span class="token operator">:</span>
  <span class="token function">oddJohn</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">oddJohn</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span>
  <span class="token boolean">false</span> <span class="token operator">:</span>
  <span class="token function">evenSteven</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token function">evenSteven</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span>
<span class="token comment">// Uncaught RangeError: Maximum call stack size exceeded</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// trampoline application code</span>
<span class="token keyword">const</span> <span class="token function-variable function">evenSteven</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span>
  <span class="token function-variable function">true</span> <span class="token operator">:</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">oddJohn</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">oddJohn</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span>
  <span class="token function-variable function">false</span> <span class="token operator">:</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">evenSteven</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">trampoline</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fun<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> result <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> <span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>


<span class="token function">trampoline</span><span class="token punctuation">(</span>evenSteven<span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="memoization" tabindex="-1"><a class="header-anchor" href="#memoization" aria-hidden="true">#</a> Memoization</h3><p>The word memoization was first used by British artificial intelligence researcher Donald Michie. Memoization was first used to refer to caching continuously used operation values ​​at the function level. This is a typical computer science trade-off: speeding up calculations at the expense of consuming space. In functional languages, for example, Clojure supports the memoize function, and the SML language handles memoization in the language itself.</p><p>Since JavaScript does not provide a function to memoize user-written functions, it is sometimes necessary to create a function that performs memoization.</p><h4 id="example-before-using-memoization" tabindex="-1"><a class="header-anchor" href="#example-before-using-memoization" aria-hidden="true">#</a> Example before using memoization</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">evenSteven</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span>
  <span class="token boolean">true</span> <span class="token operator">:</span>
  <span class="token function">oddJohn</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">oddJohn</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span>
  <span class="token boolean">false</span> <span class="token operator">:</span>
  <span class="token function">evenSteven</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">&#39;recur1&#39;</span><span class="token punctuation">)</span>
<span class="token function">evenSteven</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">&#39;recur1&#39;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">&#39;recur2&#39;</span><span class="token punctuation">)</span>
<span class="token function">evenSteven</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">&#39;recur2&#39;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">&#39;recur3&#39;</span><span class="token punctuation">)</span>
<span class="token function">evenSteven</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">&#39;recur3&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>recur1: 1.702880859375ms
recur2: 0.766845703125ms
recur3: 2.546142578125ms
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="example-after-using-memoization" tabindex="-1"><a class="header-anchor" href="#example-after-using-memoization" aria-hidden="true">#</a> Example after using memoization</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">memoize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> evenSteven <span class="token operator">=</span> <span class="token function">memoize</span><span class="token punctuation">(</span><span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span>
  <span class="token boolean">true</span> <span class="token operator">:</span>
  <span class="token function">oddJohn</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> oddJohn <span class="token operator">=</span> <span class="token function">memoize</span><span class="token punctuation">(</span><span class="token parameter">n</span> <span class="token operator">=&gt;</span> n <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span>
  <span class="token boolean">false</span> <span class="token operator">:</span>
  <span class="token function">evenSteven</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">&#39;recur1&#39;</span><span class="token punctuation">)</span>
<span class="token function">evenSteven</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">&#39;recur1&#39;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">&#39;recur2&#39;</span><span class="token punctuation">)</span>
<span class="token function">evenSteven</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">&#39;recur2&#39;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">&#39;recur3&#39;</span><span class="token punctuation">)</span>
<span class="token function">evenSteven</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">&#39;recur3&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>recur1: 2.74169921875ms
recur2: 0.00634765625ms
recur3: 0.0029296875ms
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="lazy-evaluation" tabindex="-1"><a class="header-anchor" href="#lazy-evaluation" aria-hidden="true">#</a> Lazy evaluation</h3><p>Functional languages ​​can be classified as strict evaluation languages ​​or lazy evaluation languages ​​depending on the order of evaluation. The difference between the two operation orders can be seen in the processing of function arguments. Strict evaluation languages ​​precompute function arguments and then calculate the function body, even if function arguments are not needed. However, lazy evaluation languages ​​evaluate function arguments when they are needed in the function body.</p><p>Even if it is not a lazy evaluation language, it is sometimes used by implementing lazy evaluation. It is a data structure called variously in different books such as lazy sequence, stream, or lazy collection. Here we will call it a Lazy Lists. Some languages ​​support lazy lists through the keyword <code>lazy</code>, but in languages ​​that do not, they are implemented through <code>Iterator</code>. Delay lists in JavaScript will be discussed in the main article Delay Lists.</p><h2 id="functional-data-structure" tabindex="-1"><a class="header-anchor" href="#functional-data-structure" aria-hidden="true">#</a> Functional data structure</h2><h3 id="lazy-lists" tabindex="-1"><a class="header-anchor" href="#lazy-lists" aria-hidden="true">#</a> Lazy Lists</h3>`,29),f={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators",target:"_blank",rel:"noopener noreferrer"},y=e(`<p>First, as an example of a Lazy Lists using range, when the range function is executed, it does not return a list. However, when evaluation is performed, a list is returned.</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token parameter">end<span class="token punctuation">,</span> start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&gt;</span> end <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">yield</span> start
  <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">range</span><span class="token punctuation">(</span>end<span class="token punctuation">,</span> start<span class="token operator">+</span>step<span class="token punctuation">,</span> step<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> lazyList <span class="token operator">=</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>lazyList<span class="token punctuation">)</span> <span class="token comment">// range {&lt;suspended&gt;}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">...</span>lazyList<span class="token punctuation">)</span> <span class="token comment">// 0 1 2 3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, for example, using the delay function map and the finalization function collect:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>value<span class="token punctuation">,</span> done<span class="token punctuation">}</span> <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span>
  <span class="token keyword">yield</span> <span class="token function">fn</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">map</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> list<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">collect</span> <span class="token operator">=</span> <span class="token parameter">list</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token operator">...</span>list<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can check the result of the evaluation by using the range function as the second argument of the map function and using the return value of the map function as an argument of the collect function.</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> lazyList <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">num</span> <span class="token operator">=&gt;</span> num <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">collect</span><span class="token punctuation">(</span>lazyList<span class="token punctuation">)</span> <span class="token comment">// [0, 10, 20, 30]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>If we only get the first element, we can see that it is evaluated only once. If you add logging to the map function and check, it is as follows.</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> lazyList <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">num</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> num <span class="token operator">*</span> <span class="token number">10</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;LOG: lazyList&#39;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>head<span class="token punctuation">]</span> <span class="token operator">=</span> lazyList
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// LOG: lazyList 0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="persistent-data-structures" tabindex="-1"><a class="header-anchor" href="#persistent-data-structures" aria-hidden="true">#</a> persistent data structures</h3><p>Functional languages ​​use persistent data structures. Persistence means that even when data is updated, the previous version is not changed, and only the parts that need to be changed are copied from the original. And the parts that have not changed take the form of sharing. An efficient approach is taken by using new data and sharing the parts that do not change, without making any changes to existing data.</p><p>Simple examples include linked lists and the cons function. Because ys is connected to xs, xs data uses a copy and ys shares the state.</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">cons</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>x<span class="token punctuation">,</span> xs<span class="token punctuation">]</span><span class="token punctuation">,</span> ys</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span>
    <span class="token literal-property property">ys</span> <span class="token operator">:</span>
    <span class="token punctuation">[</span>x<span class="token punctuation">,</span> <span class="token function">cons</span><span class="token punctuation">(</span>xs<span class="token punctuation">,</span> ys<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> xs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> ys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> zs <span class="token operator">=</span> <span class="token function">cons</span><span class="token punctuation">(</span>xs<span class="token punctuation">,</span> ys<span class="token punctuation">)</span> <span class="token comment">// [0,[1,[2,[3,[4,[5,[]]]]]]]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And if you forcibly change it to confirm that the status has been shared, you can see that it is shared as follows.</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;Changed&#39;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ys<span class="token punctuation">)</span> <span class="token comment">// [&#39;Changed&#39;, [4, [5, []]]]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>zs<span class="token punctuation">)</span> <span class="token comment">// [0,[1,[2,[&#39;Changed&#39;,[4,[5,[]]]]]]]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="end" tabindex="-1"><a class="header-anchor" href="#end" aria-hidden="true">#</a> end</h2>`,16);function w(x,z){const o=p("RouterLink"),t=p("ExternalLinkIcon");return i(),l("div",null,[d,k,s("p",null,[n("We researched the characteristics of functional types through a language that only supports functional types. It was found that the contents summarized in the "),a(o,{to:"/en/fe-dev/paradigm/functional.html"},{default:u(()=>[n("Functional programming theorem")]),_:1}),n(" covered only a small number of features of functional types. Also, I could see that my knowledge lacked understanding of functional types.")]),m,s("p",null,[n("JavaScript is not yet supported, but the "),s("a",v,[n("proposal-operator-overloading"),a(t)]),n(" proposal has been registered in tc39.")]),h,s("p",null,[n("As explained in words, pattern matching is a grammar that finds something that matches a pattern and executes the code block defined in that pattern. It is supported in various forms for each functional language, and although JavaScript is not yet supported, a "),s("a",b,[n("proposal-pattern-matching"),a(t)]),n(" proposal has been registered in tc39.")]),g,s("p",null,[n("Lazy Lists are implemented in a way that elements are evaluated when they are needed. The Lazy Lists uses a combination of lazy functions, and selects when evaluation is needed through a termination function. In JavaScript, it can be implemented through "),s("a",f,[n("Iterator"),a(t)]),n(".")]),y])}const S=c(r,[["render",w],["__file","functional2.html.vue"]]);export{S as default};
